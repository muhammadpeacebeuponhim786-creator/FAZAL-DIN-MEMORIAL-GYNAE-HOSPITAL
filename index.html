<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Blood Tests - CityCare Gynae Hospital</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      transition: background-image 1s ease-in-out;
      color: #111;
    }
    header {
      text-align: center;
      padding: 20px;
      background: rgba(255,255,255,0.85);
      border-bottom: 3px solid #444;
    }
    header h1 {
      margin: 0;
      font-size: 60px;
      color: #2a4d69;
    }
    header p {
      font-size: 24px;
      margin: 5px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px auto;
      background: rgba(255,255,255,0.9);
      border-radius: 12px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 12px;
      font-size: 50px;
      text-align: center;
    }
    th {
      background: #2a4d69;
      color: #fff;
    }
    td label {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .total {
      font-weight: bold;
      font-size: 55px;
      margin: 20px;
      text-align: center;
      background: rgba(255,255,255,0.8);
      padding: 15px;
      border-radius: 12px;
    }
    .selected-list {
      background: rgba(255,255,255,0.85);
      margin: 20px;
      padding: 20px;
      border-radius: 12px;
      font-size: 40px;
    }
    .selected-list h3 {
      margin-top: 0;
      color: #2a4d69;
    }
    .buttons {
      text-align: center;
      margin: 20px;
    }
    .buttons button {
      margin: 10px;
      padding: 15px 30px;
      font-size: 40px;
      border: none;
      border-radius: 10px;
      background: #2a4d69;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    .buttons button:hover {
      background: #41729f;
    }
    @media (max-width: 768px) {
      header h1 { font-size: 45px; }
      header p { font-size: 20px; }
      th, td { font-size: 36px; }
      .total { font-size: 40px; }
      .selected-list { font-size: 32px; }
      .buttons button { font-size: 30px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Faza Din Memorial Gynae Hospital Narowal</h1>
    <p>Blood Tests Department</p>
    <p id="todayDate"></p>
  </header>

  <table>
    <thead>
      <tr>
        <th><input type="checkbox" id="selectAll"> All</th>
        <th>#</th>
        <th>Test Name</th>
        <th>Amount (Rs.)</th>
      </tr>
    </thead>
    <tbody>
      <tr><td><input type="checkbox" class="test" data-price="400"></td><td>1</td><td>HBA1C</td><td>400</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="250"></td><td>2</td><td>HB%</td><td>250</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="200"></td><td>3</td><td>Blood Group</td><td>200</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="600"></td><td>4</td><td>CBC</td><td>600</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="300"></td><td>5</td><td>BSR</td><td>300</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="150"></td><td>6</td><td>ESR</td><td>150</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="500"></td><td>7</td><td>CRP</td><td>500</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="450"></td><td>8</td><td>LDH</td><td>450</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="350"></td><td>9</td><td>Cholesterol</td><td>350</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="400"></td><td>10</td><td>Uric Acid</td><td>400</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="300"></td><td>11</td><td>PT</td><td>300</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="350"></td><td>12</td><td>APTT</td><td>350</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="400"></td><td>13</td><td>INR</td><td>400</td></tr>
      <tr><td><input type="checkbox" class="test" data-price="700"></td><td>14</td><td>Cross Match</td><td>700</td></tr>
    </tbody>
  </table>

  <div class="total">Total (14 Tests): Rs. <span id="total">0</span></div>

  <div class="selected-list" id="selectedList" style="display:none;">
    <h3>Selected Tests (<span id="count">0</span>):</h3>
    <ul id="listItems"></ul>
  </div>

  <div class="buttons">
    <button onclick="printPage()">üñ®Ô∏è Print</button>
    <button onclick="downloadPDF()">üìÑ PDF</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const checkboxes = document.querySelectorAll('.test');
    const selectAll = document.getElementById('selectAll');
    const totalEl = document.getElementById('total');
    const listItems = document.getElementById('listItems');
    const selectedList = document.getElementById('selectedList');
    const countEl = document.getElementById('count');
    const todayDate = document.getElementById('todayDate');

    // Show today's date
    todayDate.textContent = "Date: " + new Date().toLocaleDateString();

    function updateSummary() {
      let total = 0, count = 0;
      listItems.innerHTML = "";
      checkboxes.forEach(cb => {
        if (cb.checked) {
          total += parseInt(cb.dataset.price);
          count++;
          const li = document.createElement("li");
          li.textContent = cb.parentElement.nextElementSibling.nextElementSibling.textContent + " - Rs." + cb.dataset.price;
          li.style.background = "#e6f2ff";
          li.style.padding = "8px";
          li.style.margin = "4px 0";
          li.style.borderRadius = "8px";
          listItems.appendChild(li);
        }
      });
      totalEl.textContent = total;
      countEl.textContent = count;
      selectedList.style.display = count > 0 ? "block" : "none";
    }

    checkboxes.forEach(cb => cb.addEventListener('change', updateSummary));

    // Select all checkbox
    selectAll.addEventListener('change', () => {
      checkboxes.forEach(cb => cb.checked = selectAll.checked);
      updateSummary();
    });

    // Background slideshow (20 images)
    const images = [
      "https://source.unsplash.com/1600x900/?hospital",
      "https://source.unsplash.com/1600x900/?doctor",
      "https://source.unsplash.com/1600x900/?lab",
      "https://source.unsplash.com/1600x900/?medicine",
      "https://source.unsplash.com/1600x900/?xray",
      "https://source.unsplash.com/1600x900/?blood",
      "https://source.unsplash.com/1600x900/?microscope",
      "https://source.unsplash.com/1600x900/?injection",
      "https://source.unsplash.com/1600x900/?tablet",
      "https://source.unsplash.com/1600x900/?syringe",
      "https://source.unsplash.com/1600x900/?nurse",
      "https://source.unsplash.com/1600x900/?stethoscope",
      "https://source.unsplash.com/1600x900/?health",
      "https://source.unsplash.com/1600x900/?test",
      "https://source.unsplash.com/1600x900/?dna",
      "https://source.unsplash.com/1600x900/?pharmacy",
      "https://source.unsplash.com/1600x900/?bloodtest",
      "https://source.unsplash.com/1600x900/?research",
      "https://source.unsplash.com/1600x900/?biotech",
      "https://source.unsplash.com/1600x900/?gynae"
    ];
    let index = 0;
    setInterval(() => {
      document.body.style.backgroundImage = `url(${images[index]})`;
      index = (index + 1) % images.length;
    }, 5000);

    // Print
    function printPage() {
      window.print();
    }

    // PDF
    async function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(18);
      doc.text("CityCare Gynae Hospital", 60, 20);
      doc.setFontSize(12);
      doc.text(todayDate.textContent, 10, 35);
      doc.setFontSize(14);
      doc.text("Blood Test Receipt", 10, 50);
      let y = 65;
      checkboxes.forEach(cb => {
        if (cb.checked) {
          doc.text(cb.parentElement.nextElementSibling.nextElementSibling.textContent + " - Rs." + cb.dataset.price, 10, y);
          y += 10;
        }
      });
      doc.text("Total: Rs." + totalEl.textContent, 10, y + 10);
      doc.save("Blood_Tests.pdf");
    }
  </script>
</body>
</html>